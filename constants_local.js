const localNamedRanges = {
  "lookupRiderTypes": {
    "sheetName":"Lookups",
    "headerName":"Rider Types"
  },
  "lookupMobilityFactors": {
    "sheetName":"Lookups",
    "headerName":"Mobility Factors"
  },
  "lookupFareTypes": {
    "sheetName":"Lookups",
    "headerName":"Fare Types"
  },
  "formulaTripReviewCoreData": {
    "sheetName":"Trip Review",
    "startHeaderName":"Trip Date",
    "endHeaderName":"Run ID",
  },
  "formulaRunsSheet": {
    "sheetName":"Runs",
    "startHeaderName":"Run Date",
    "endHeaderName":"Scheduled End Time",
    "allRows": true
  },
  "formulaRunReviewRunDate": {
    "sheetName":"Run Review",
    "headerName":"Run Date"
  },
  "formulaRunReviewDriverId": {
    "sheetName":"Run Review",
    "headerName":"Driver ID"
  },
  "formulaRunReviewVehicleId": {
    "sheetName":"Run Review",
    "headerName":"Vehicle ID"
  },
  "formulaRunReviewRunId": {
    "sheetName":"Run Review",
    "headerName":"Run ID"
  },
  "formulaRunReviewBreakTime": {
    "sheetName":"Run Review",
    "headerName":"Break Time in Minutes"
  },
  "formulaRunReviewFareRevenue": {
    "sheetName":"Run Review",
    "headerName":"Fare Revenue"
  },
  "formulaRunReviewDonationRevenue": {
    "sheetName":"Run Review",
    "headerName":"Donation Revenue"
  },
  "formulaRunReviewTicketRevenue": {
    "sheetName":"Run Review",
    "headerName":"Ticket Revenue"
  },
  "formulaRunReviewTimeStart": {
    "sheetName":"Run Review",
    "headerName":"Actual Start Time"
  },
  "formulaRunReviewTimeEnd": {
    "sheetName":"Run Review",
    "headerName":"Actual End Time"
  },
  "formulaRunReviewOdoStart": {
    "sheetName":"Run Review",
    "headerName":"Odometer Start"
  },
  "formulaRunReviewOdoEnd": {
    "sheetName":"Run Review",
    "headerName":"Odometer End"
  },
  "formulaRunReviewStartingDeadheadMiles": {
    "sheetName":"Run Review",
    "headerName":"Starting Deadhead Miles"
  },
  "formulaRunReviewEndingDeadheadMiles": {
    "sheetName":"Run Review",
    "headerName":"Ending Deadhead Miles"
  },
  "formulaRunReviewTotalDeadheadMiles": {
    "sheetName":"Run Review",
    "headerName":"Total Deadhead Miles"
  },
  "formulaRunReviewTotalVehicleMiles": {
    "sheetName":"Run Review",
    "headerName":"Total Vehicle Miles"
  },
  "formulaRunReviewStartingDeadheadHours": {
    "sheetName":"Run Review",
    "headerName":"Starting Deadhead Hours"
  },
  "formulaRunReviewEndingDeadheadHours": {
    "sheetName":"Run Review",
    "headerName":"Ending Deadhead Hours"
  },
  "formulaRunReviewTotalNonRevenueHours": {
    "sheetName":"Run Review",
    "headerName":"Total Non-Revenue Hours"
  },
  "formulaRunReviewTotalVehicleHours": {
    "sheetName":"Run Review",
    "headerName":"Total Vehicle Hours"
  },
    "formulaRunArchiveRunDate": {
    "sheetName":"Run Archive",
    "headerName":"Run Date"
  },
  "formulaRunsDriverId": {
    "sheetName":"Runs",
    "headerName":"Driver ID"
  },
  "formulaRunsVehicleId": {
    "sheetName":"Runs",
    "headerName":"Vehicle ID"
  },
  "formulaRunsRunId": {
    "sheetName":"Runs",
    "headerName":"Run ID"
  },
  "formulaRunArchiveBreakTime": {
    "sheetName":"Run Archive",
    "headerName":"Break Time in Minutes"
  },
  "formulaRunArchiveFareRevenue": {
    "sheetName":"Run Archive",
    "headerName":"Fare Revenue"
  },
  "formulaRunArchiveDonationRevenue": {
    "sheetName":"Run Archive",
    "headerName":"Donation Revenue"
  },
  "formulaRunArchiveTicketRevenue": {
    "sheetName":"Run Archive",
    "headerName":"Ticket Revenue"
  },
  "formulaRunArchiveOdoStart": {
    "sheetName":"Run Archive",
    "headerName":"Odometer Start"
  },
  "formulaRunArchiveOdoEnd": {
    "sheetName":"Run Archive",
    "headerName":"Odometer End"
  },
    "formulaRunArchiveTimeStart": {
    "sheetName":"Run Archive",
    "headerName":"Actual Start Time"
  },
  "formulaRunArchiveTimeEnd": {
    "sheetName":"Run Archive",
    "headerName":"Actual End Time"
  },
"formulaRunArchiveStartingDeadheadMiles": {
    "sheetName":"Run Archive",
    "headerName":"Starting Deadhead Miles"
  },
  "formulaRunArchiveEndingDeadheadMiles": {
    "sheetName":"Run Archive",
    "headerName":"Ending Deadhead Miles"
  },
  "formulaRunArchiveTotalDeadheadMiles": {
    "sheetName":"Run Archive",
    "headerName":"Total Deadhead Miles"
  },
  "formulaRunArchiveTotalVehicleMiles": {
    "sheetName":"Run Archive",
    "headerName":"Total Vehicle Miles"
  },
  "formulaRunArchiveStartingDeadheadHours": {
    "sheetName":"Run Archive",
    "headerName":"Starting Deadhead Hours"
  },
  "formulaRunArchiveEndingDeadheadHours": {
    "sheetName":"Run Archive",
    "headerName":"Ending Deadhead Hours"
  },
  "formulaRunArchiveTotalNonRevenueHours": {
    "sheetName":"Run Archive",
    "headerName":"Total Non-Revenue Hours"
  },
  "formulaRunArchiveTotalVehicleHours": {
    "sheetName":"Run Archive",
    "headerName":"Total Vehicle Hours"
  },
  "formulaTripArchiveTripDate": {
    "sheetName":"Trip Archive",
    "headerName":"Trip Date"
  },
  "formulaTripArchiveCustomerId": {
    "sheetName":"Trip Archive",
    "headerName":"Customer ID"
  },
  "formulaTripArchivePuTime": {
    "sheetName":"Trip Archive",
    "headerName":"PU Time"
  },
  "codeFormatAddress9": {
    "sheetName":"Addresses",
    "headerName":"Address"
  },
  "lookupRiderTypes": {
    "sheetName":"Lookups",
    "headerName":"Rider Types"
  },
  "lookupMobilityFactors": {
    "sheetName":"Lookups",
    "headerName":"Mobility Factors"
  },
  "lookupFareTypes": {
    "sheetName":"Lookups",
    "headerName":"Fare Types"
  },
}
const localNamedRangesToRemove = [
  "codeCheckSourceOnShare",
  "codeVerifySourceOnEdit",
  "queryServiceEndDate",
  "queryServiceId"
]

const localSheetsToRemove = ["Services","Sent Trips","Outside Trips","Outside Runs"]
const localSheets = ["Addresses"]
const localSheetsWithHeaders = ["Addresses"]

const localColumnsToRemove = {}
const localColumns = {
  Customers: {
    "Default Rider Type": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupRiderTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Default Trip Purpose": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupRiderTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Default Mobility Factors": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupMobilityFactors",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid mobility factor.",
      },
    },
    "Default Fare": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupFareTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid fare type.",
      },
    },
    "Default Trip Purpose": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupTripPurposes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid trip purpose.",
      },
    },
  },
  Trips: {
    "Will Call": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "WILL CALL",
        allowInvalid: false,
      },
    },
    "SDR": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "TRUE",
        allowInvalid: false,
      },
    },
    "|Run OK?|": {
      headerFormula: `={"|Run OK?|";MAP(formulaTripsTripDate, formulaTripsPuTime, formulaTripsDoTime, formulaTripsTripDriverId, formulaTripsTripVehicleId, formulaTripsTripRunId, LAMBDA(TripDate,TripPuTime,TripDoTime,TripDriverId,TripVehicleID,TripRunId, QUERY_RUN_MATCH_COUNT(TripDate,TripPuTime,TripDoTime,TripDriverId,TripVehicleID,TripRunId,formulaRunsSheet)))}`
    },
    "Rider Type": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupRiderTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Trip Purpose": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupTripPurposes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Mobility Factors": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupMobilityFactors",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid mobility factor.",
      },
    },
    "Fare": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupFareTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid fare type.",
      },
    },
    "Day of Week": {
      headerFormula: `={"Day of Week";arrayformula(if(ISBLANK(A2:A), "", (TEXT(A2:A, "DDDD"))))}`
    }
  },
  "Runs": {
    "|First PU Time|": {
      headerFormula: `={"|First PU Time|","|Last DO Time|","|Trip Count|";MAP(formulaRunsRunDate, formulaRunsDriverId, formulaRunsVehicleId, formulaRunsRunId, LAMBDA(RunDate,RunDriverId,RunVehicleID,RunRunId, QUERY_RUN_TRIP_TIMES(RunDate,RunDriverId,RunVehicleID,RunRunId, formulaTripsCoreData, formulaTripsCoreHeaders)))}`,
      numberFormat: 'h":"mm am/pm',
    },
    "|Last DO Time|": {
      headerFormula: "",
      numberFormat: 'h":"mm am/pm',
    },
    "|Trip Count|": {
      headerFormula: "",
      numberFormat: '0',
    },
  },
  "Trip Review": {
    "Will Call": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "WILL CALL",
        allowInvalid: true,
      },
    },
    "SDR": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "TRUE",
        allowInvalid: true,
      },
    },
    "Rider Type": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupRiderTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Trip Purpose": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupTripPurposes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Mobility Factors": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupMobilityFactors",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid mobility factor.",
      },
    },
    "Fare": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupFareTypes",
        showDropdown: true,
        allowInvalid: false,
        helpText: "Value must be a valid fare type.",
      },
    },
  },
  "Run Review": {
    "Tickets Used": {
      numberFormat: "0"
    },
    "Fare Revenue": {
      numberFormat: "$0.00"
    },
    "Donation Revenue": {
      numberFormat: "$0.00"
    },
    "Ticket Revenue": {
      numberFormat: "$0.00"
    },
    "Total Revenue": {
      headerFormula: `={"Total Revenue";MAP(formulaRunReviewFareRevenue,formulaRunReviewDonationRevenue,formulaRunReviewTicketRevenue,LAMBDA(source1,source2,source3,IF(COUNTBLANK(source1,source2,source3)>0,"",SUM(source1,source2,source3))))}`
    },
    "Total Vehicle Miles": {
      headerFormula: `={"Total Vehicle Miles";MAP(formulaRunReviewOdoStart,formulaRunReviewOdoEnd,LAMBDA(startOdo,endOdo,IF(COUNTBLANK(startOdo,endOdo)>0,"",endOdo-startOdo)))}`
    },
    "Total Deadhead Miles": {
      headerFormula: `={"Total Deadhead Miles";MAP(formulaRunReviewStartingDeadheadMiles,formulaRunReviewEndingDeadheadMiles,LAMBDA(start,end,IF(COUNTBLANK(start,end)>0,"",start+end)))}`
    },
    "Revenue Miles": {
      headerFormula: `={"Revenue Miles";MAP(formulaRunReviewTotalVehicleMiles,formulaRunReviewTotalDeadheadMiles,LAMBDA(vehicleMiles,deadheadMiles,IF(COUNTBLANK(vehicleMiles,deadheadMiles) > 0,"",vehicleMiles-deadheadMiles)))}`
    },
    "Total Vehicle Hours": {
      headerFormula: `={"Total Vehicle Hours";MAP(formulaRunReviewTimeStart,formulaRunReviewTimeEnd,LAMBDA(start,end,IF(COUNTBLANK(start,end)>0,"",end-start)))}`,
      numberFormat: "[h]:mm"
    },
    "Total Non-Revenue Hours": {
      headerFormula: `={"Total Non-Revenue Hours";MAP(formulaRunReviewStartingDeadheadHours,formulaRunReviewEndingDeadheadHours,formulaRunReviewBreakTime,LAMBDA(start,end,middle,IF(COUNTBLANK(start,end,middle)>0,"",start+end+(middle/1440))))}`,
      numberFormat: "[h]:mm"
    },
    "Revenue Hours": {
      headerFormula: `={"Revenue Hours";MAP(formulaRunReviewTotalVehicleHours,formulaRunReviewTotalNonRevenueHours,LAMBDA(vehicleHours,deadheadHours,IF(COUNTBLANK(vehicleHours,deadheadHours)>0,"",vehicleHours-deadheadHours)))}`,
      numberFormat: "[h]:mm"
    },
    "Starting Deadhead Miles": {
      numberFormat: "0.0"
    },
    "Ending Deadhead Miles": {
      numberFormat: "0.0"
    },
    "Starting Deadhead Hours": {
      numberFormat: "[h]:mm"
    },
    "Ending Deadhead Hours": {
      numberFormat: "[h]:mm"
    },
    "Vehicle Garage Address": {},
    "First PU Address": {},
    "Last DO Address": {}
  },
  "Trip Archive": {
    "Will Call": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "WILL CALL",
        allowInvalid: false,
      },
    },
    "SDR": {
      dataValidation: {
        criteriaType: "CHECKBOX",
        checkedValue: "TRUE",
        allowInvalid: false,
      },
    },
    "Rider Type": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupRiderTypes",
        showDropdown: false,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Trip Purpose": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupTripPurposes",
        showDropdown: false,
        allowInvalid: false,
        helpText: "Value must be a valid rider type.",
      },
    },
    "Mobility Factors": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupMobilityFactors",
        showDropdown: false,
        allowInvalid: false,
        helpText: "Value must be a valid mobility factor.",
      },
    },
    "Fare": {
      dataValidation: {
        criteriaType: "VALUE_IN_RANGE",
        namedRange: "lookupFareTypes",
        showDropdown: false,
        allowInvalid: false,
        helpText: "Value must be a valid fare type.",
      },
    },
  },
  "Run Archive": {
    "Tickets Used": {
      numberFormat: "0"
    },
    "Fare Revenue": {
      numberFormat: "$0.00"
    },
    "Donation Revenue": {
      numberFormat: "$0.00"
    },
    "Ticket Revenue": {
      numberFormat: "$0.00"
    },
    "Total Revenue": {
      headerFormula: `={"Total Revenue";MAP(formulaRunArchiveFareRevenue,formulaRunArchiveDonationRevenue,formulaRunArchiveTicketRevenue,LAMBDA(source1,source2,source3,IF(COUNTBLANK(source1,source2,source3)>0,"",SUM(source1,source2,source3))))}`
    },
    "Total Vehicle Miles": {
      headerFormula: `={"Total Vehicle Miles";MAP(formulaRunArchiveOdoStart,formulaRunArchiveOdoEnd,LAMBDA(startOdo,endOdo,IF(COUNTBLANK(startOdo,endOdo)>0,"",endOdo-startOdo)))}`
    },
    "Total Deadhead Miles": {
      headerFormula: `={"Total Deadhead Miles";MAP(formulaRunArchiveStartingDeadheadMiles,formulaRunArchiveEndingDeadheadMiles,LAMBDA(start,end,IF(COUNTBLANK(start,end)>0,"",start+end)))}`
    },
    "Revenue Miles": {
      headerFormula: `={"Revenue Miles";MAP(formulaRunArchiveTotalVehicleMiles,formulaRunArchiveTotalDeadheadMiles,LAMBDA(vehicleMiles,deadheadMiles,IF(COUNTBLANK(vehicleMiles,deadheadMiles)>0,"",vehicleMiles-deadheadMiles)))}`
    },
    "Total Vehicle Hours": {
      headerFormula: `={"Total Vehicle Hours";MAP(formulaRunArchiveTimeStart,formulaRunArchiveTimeEnd,LAMBDA(start,end,IF(COUNTBLANK(start,end)>0,"",end-start)))}`,
      numberFormat: "[h]:mm"
    },
    "Total Non-Revenue Hours": {
      headerFormula: `={"Total Non-Revenue Hours";MAP(formulaRunArchiveStartingDeadheadHours,formulaRunArchiveEndingDeadheadHours,formulaRunArchiveBreakTime,LAMBDA(start,end,middle,IF(COUNTBLANK(start,end,middle)>0,"",start+end+(middle/1440))))}`,
      numberFormat: "[h]:mm"
    },
    "Revenue Hours": {
      headerFormula: `={"Revenue Hours";MAP(formulaRunArchiveTotalVehicleHours,formulaRunArchiveTotalNonRevenueHours,LAMBDA(vehicleHours,deadheadHours,IF(COUNTBLANK(vehicleHours,deadheadHours)>0,"",vehicleHours-deadheadHours)))}`,
      numberFormat: "[h]:mm"
    },
    "Starting Deadhead Miles": {
      numberFormat: "0.0"
    },
    "Ending Deadhead Miles": {
      numberFormat: "0.0"
    },
    "Starting Deadhead Hours": {
      numberFormat: "[h]:mm"
    },
    "Ending Deadhead Hours": {
      numberFormat: "[h]:mm"
    },
    "Vehicle Garage Address": {},
    "First PU Address": {},
    "Last DO Address": {}
  },
  "Trip Archive": {
    "Trip Reverse Sequence": {
      headerFormula: `={"Trip Reverse Sequence";MAP(formulaTripArchiveTripDate, formulaTripArchiveCustomerId, formulaTripArchivePuTime, LAMBDA(tripDate,customerId, PuTime, IF(ISBLANK(tripDate),"",COUNTIFS(formulaTripArchiveTripDate, tripDate, formulaTripArchiveCustomerId, customerId, formulaTripArchivePuTime, ">" & PuTime)+1)))}`
    },
    "Trip Sequence": {
      headerFormula: `={"Trip Sequence";MAP(formulaTripArchiveTripDate, formulaTripArchiveCustomerId, formulaTripArchivePuTime, LAMBDA(tripDate,customerId, PuTime, IF(ISBLANK(tripDate),"",COUNTIFS(formulaTripArchiveTripDate, tripDate, formulaTripArchiveCustomerId, customerId, formulaTripArchivePuTime, "<" & PuTime)+1)))}`
    },
  },
  "Addresses": {
    "Short Name": {},
    "Address": {},
  },
  "Lookups": {
    "Rider Types": {},
    "Mobility Factors": {},
    "Fare Types": {},
  }

}
